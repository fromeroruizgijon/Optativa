<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="/css/index.css">
</head>
<body>
    <header class="app-header">
        <div class="brand">FiumPlan Panel</div>
        <nav class="user-nav">
            <ul>
                <li style="display: flex; align-items: center; gap: 10px;">
                    <img th:src="${usuario.imagenUrl}" style="width: 32px; height: 32px; object-fit: cover; border: 2px solid #e2e8f0;">
                    <span th:text="${usuario.nombre}"></span>
                </li>
                <li><a href="/logout">Cerrar Sesión</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <div class="section-header">
            <h2>Proyectos Activos</h2>
            <a href="crearProyecto" class="btn-create-main">Crear Nuevo Proyecto</a>
        </div>
        
        <div class="projects-grid">
            <div th:each="proyecto : ${listaProyectos}" class="project-panel">
                
                <div class="panel-header">
                    <h3 class="panel-title">
                        <a th:href="@{/verProyecto(nombre=${proyecto.nombre})}" th:text="${proyecto.nombre}"></a>
                    </h3>
                </div>

                <div class="panel-body">
                    <p class="panel-desc" th:text="${proyecto.descripcion}"></p>
                    
                    <div class="progress-section">
                        <div class="progress-label">
                            <span>Completado</span>
                            <span th:text="${#numbers.formatDecimal(proyecto.porcentajeCompletado, 0, 0)} + '%'"></span>
                        </div>
                        <div class="progress-track">
                            <div class="progress-fill" th:style="'width:' + ${proyecto.porcentajeCompletado} + '%'"></div>
                        </div>
                    </div>
                </div>

                <div class="panel-footer">
                    <a th:href="@{/editarProyecto(id=${proyecto.id})}" class="action-link link-edit">Editar</a>
                   <button class="action-link link-delete" 
                            th:onclick="'confirmarBorrado(\'/borrarProyecto?id=' + ${proyecto.id} + '\')'">
                        Borrar
                    </button>
                </div>
            </div>
        </div>
    </main>
    <div id="modalConfirmar" class="modal-overlay">
    <div class="modal-box">
        <h3>¿Estás seguro?</h3>
        <p>Esta acción eliminará el elemento permanentemente.</p>
        <div class="modal-actions">
            <button onclick="cerrarModal()" class="btn-cancel">Cancelar</button>
            <a id="btnConfirmarBorrado" href="#" class="btn-delete-confirm">Sí, borrar</a>
        </div>
    </div>
</div>
</body>
</html>